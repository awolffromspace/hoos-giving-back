{% extends 'donations/base.html' %}
{% block content %}

{% if user.is_authenticated %}
  <form action="/donations/donate/" method="post">
    {% csrf_token %}
    {{ form.as_p }}
    <input type="submit" value="Submit" class="btn btn-primary">
  </form>

  <ul id="sliders">
    <li>
      <div class="slider">20</div>
      <span class="value">0</span>%
    </li>
    <li>
      <div class="slider">20</div>
      <span class="value" >0</span>%
    </li>
    <li>
      <div class="slider">20</div>
      <span class="value">0</span>%
    </li>
    <li>
      <div class="slider">20</div>
      <span class="value">0</span>%
    </li>
    <li>
      <div class="slider">20</div>
      <span class="value">0</span>%
    </li>
  </ul>

  <h3>The Trevor Project</h3>
  <p>The ultimate goal of The Trevor Project is to end suicide among LGBTQ people under 25 by providing them with counseling and education. It offers young people support with trained counselors via phone, text, and online chat. Every $1 donated allows people to get one more minute of counseling.</p>
  <h3>The National Immigration Law Center</h3>
  <p>This nonprofit has defended the rights of low-income immigrants in the US since 1979. It works to provide immigrants access to health care and fights unconstitutional immigration policy. The nonprofit also works to educate the public on the impact new laws would have on this marginalized group.</p>
  <h3>Human Rights Watch</h3>
  <p> Defending the rights of people across the globe is no small task, but the organization Human Rights Watch has been doing just this since 1978. About 400 journalists, attorneys, country experts, and many others work to publish non-partisan and independent reports every year on human rights conditions around the world.</p>
  <h3>The Global Fund for Women</h3>
  <p>The Global Fund for Women proudly calls itself and its supporters champions for equality. From setting up the first women’s fund in Nepal to funding secret schools in Afghanistan, this bold organization strives to empower women and girls around the world and ensure they are granted basic human rights.</p>
  <h3>Charity Water</h3>
  <p>According to charity: water, one in 10 people don’t have access to clean drinking water. The organization hopes to change these stats by bringing clean and safe drinking water to developing countries. It has already funded over 29,000 water projects around the world.</p>
  <h3>Mental Health America</h3>
  <p>Founded in 1909, Mental Health America helps Americans understand, prevent, and treat mental health issues that can interfere with their overall wellness and ability to live a healthy life. They also focus on educating Americans about mental health issues through their online hub of information and tools.</p>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
  <script>
var sliders = $("#sliders .slider");
var availableTotal = 100;

sliders.each(function() {
    var init_value = parseInt($(this).text());

    $(this).siblings('.value').text(init_value);

    $(this).empty().slider({
        value: init_value,
        min: 0,
        max: availableTotal,
        range: "max",
        step: 1,
        animate: 0,
        slide: function(event, ui) {
            
            // Update display to current value
            $(this).siblings('.value').text(ui.value);

            // Get current total
            var total = 0;

            sliders.not(this).each(function() {
                total += $(this).slider("option", "value");
            });

            // Need to do this because apparently jQ UI
            // does not update value until this event completes
            total += ui.value;

            var delta = availableTotal - total;
            
            // Update each slider
            sliders.not(this).each(function() {
                var t = $(this),
                    value = t.slider("option", "value");

                var new_value = value + (delta/4);
                
                if (new_value < 0 || ui.value == 100) 
                    new_value = 0;
                if (new_value > 100) 
                    new_value = 100;

                t.siblings('.value').text(new_value);
                t.slider('value', new_value);
            });
        }
    });
});
  </script>
{% else %}
  <p>You aren't logged in.</p>
{% endif %}

{% endblock content %}